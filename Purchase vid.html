<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="AquaCheese">
        <title>AquaCheese Photography - Purchase Page</title>
        
       <style>
    body {
        background-color: #333;
        color: whitesmoke;
        text-align: center;
        font-family: Arial, Helvetica, sans-serif;
    }

    a {
        color: cornsilk;
    }
    a:visited {
        color: aqua;
    }
    a:hover {
        color: gray;
    }
    a:active {
        color: white;
    }

    form {
        background-color: #444;
        padding: 30px; /* Add padding for better spacing */
        border-radius: 10px; /* Rounded corners */
        display: inline-block;
        text-align: left;
        color: whitesmoke;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Add a subtle shadow */
        margin: 20px auto; /* Center the form vertically */
        width: 90%; /* Ensure the form doesn't stretch too wide */
        max-width: 400px; /* Limit the maximum width */
    }

    label {
        display: block;
        margin: 10px 0 5px;
    }

    input, select, button {
        width: 100%;
        padding: 10px;
        margin-bottom: 15px;
        border-radius: 5px;
        border: 1px solid #ccc;
        font-size: 16px;
    }

    button {
        background-color: green;
        color: white;
        border: none;
        cursor: pointer;
    }

    button:hover {
        background-color: darkgreen;
    }

    /* Profile menu styles */
    #profileMenu {
        display: none;
        position: absolute;
        top: 60px;
        left: 20px;
        background-color: #444;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        padding: 10px;
        min-width: 200px;
    }

    #profileMenu button {
        background-color: transparent;
        color: whitesmoke;
        border: none;
        text-align: left;
        padding: 10px;
        width: 100%;
        cursor: pointer;
    }

    #profileMenu button:hover {
        background-color: #555;
    }

    /* Media upload button styles */
    #upload-button-section {
        display: none;
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
    }

    #upload-page-button {
        font-size: large;
        padding: 10px 20px;
        border-radius: 5px;
        background-color: lightblue;
        border: none;
        cursor: pointer;
    }

    /* Login modal styles */
    #loginModal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }

    #loginModal > div {
        background-color: #333;
        color: whitesmoke;
        padding: 20px;
        border-radius: 8px;
        width: 300px;
        text-align: center;
    }

    #loginModal h2 {
        margin: 0 0 15px 0;
        font-size: 24px;
    }

    #loginModal button {
        background-color: #555;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        margin: 10px 0;
        width: 100%;
    }

    #loginModal button:hover {
        background-color: #666;
    }

    /* Error message styles */
    .error-message {
        color: #ff6666;
        margin-top: 8px;
        min-height: 20px;
    }
</style>
        <link rel="icon" href="AquaCheese Logo.png">
    </head>
    <body>
        <!-- Login/Profile Modal and Menu (from index.html) -->
        <div style="position: fixed; top: 20px; left: 20px; z-index: 1000;">
          <button id="loginButton" style="background-color: lightblue; color: black; border: none; border-radius: 12px; padding: 10px 20px; font-size: 16px; cursor: pointer;">
            Log In
          </button>
          <section id="upload-button-section" style="display: none;">
            <button id="upload-page-button" style="font-size: large; padding: 10px 20px; border-radius: 5px; background-color: lightblue; border: none; cursor: pointer;">
              Upload Media
            </button>
          </section>
        </div>
        <div id="loginModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000;">
          <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #333; color: whitesmoke; padding: 20px; border-radius: 8px; width: 300px; text-align: center;">
            <h2>Log In</h2>
            <button id="googleLoginButton" style="background-color: #4285F4; color: white; border: none; border-radius: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 10px;">Log In with Google</button>
            <button id="showEmailLoginForm" style="background-color: #555; color: white; border: none; border-radius: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 10px;">Log In with Email</button>
            <button id="showRegisterForm" style="background-color: #ffc107; color: black; border: none; border-radius: 5px; padding: 8px 16px; font-size: 15px; cursor: pointer; margin: 10px; display: inline-block;">Register</button>
            <form id="emailLoginForm" class="hidden" style="margin-top:10px;">
              <input id="emailInput" type="email" placeholder="Email" required style="width:90%;margin-bottom:8px;padding:8px;border-radius:5px;border:none;">
              <input id="passwordInput" type="password" placeholder="Password" required style="width:90%;margin-bottom:8px;padding:8px;border-radius:5px;border:none;">
              <button type="submit" style="background-color: #555; color: white; border: none; border-radius: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 10px;">Log In</button>
              <button type="button" id="cancelEmailLogin" style="background-color: #dc3545; color: white; border: none; border-radius: 5px; padding: 8px 16px; font-size: 15px; cursor: pointer; margin: 10px;">Cancel</button>
            </form>
            <form id="registerForm" class="hidden" style="margin-top:10px;">
              <input id="registerEmail" type="email" placeholder="Email" required style="width:90%;margin-bottom:8px;padding:8px;border-radius:5px;border:none;">
              <input id="registerPassword" type="password" placeholder="Password" required style="width:90%;margin-bottom:8px;padding:8px;border-radius:5px;border:none;">
              <button type="submit" style="background-color: #28a745; color: white; border: none; border-radius: 5px; padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 10px;">Register</button>
              <button type="button" id="cancelRegister" style="background-color: #dc3545; color: white; border: none; border-radius: 5px; padding: 8px 16px; font-size: 15px; cursor: pointer; margin: 10px;">Cancel</button>
            </form>
            <div id="emailLoginError" class="error-message"></div>
            <br>
            <hr style="border: 0; border-top: 1px solid #888; margin: 16px 0 8px 0;">
            <button id="closeLoginModal" style="background-color: red; color: white; border: none; border-radius: 5px; padding: 5px 10px; font-size: 14px; cursor: pointer; margin-top: 10px;">Close</button>
            <button id="logoutButton" style="background-color: #343a40; color: white; border: none; border-radius: 5px; padding: 8px 16px; font-size: 15px; cursor: pointer; margin: 10px; display: none;">Log Out</button>
          </div>
        </div>

        <!-- Profile Menu (from index.html) -->
        <div id="profileMenu">
          <button id="viewProfileButton">View Profile</button>
          <button id="logoutButton2">Log Out</button>
        </div>

        <h1>Checkout Page</h1>
        <p>Please fill out the form below to complete your purchase.</p>

        <form id="paymentForm">
            <label for="name">Full Name</label>
            <input type="text" id="name" name="name" placeholder="Enter your full name" required>

            <label for="email">Email Address</label>
            <input type="email" id="email" name="email" placeholder="Enter your email address" required>

            <label for="amount">Amount Due (£)</label>
            <input type="text" id="amount" name="amount" value="20.00" readonly>

            <label for="paymentMethod">Payment Method</label>
            <select id="paymentMethod" name="paymentMethod" required>
                <option value="creditCard">Credit/Debit Card</option>
                <option value="paypal">PayPal</option>
            </select>

            <button type="submit">Pay Now</button>
        </form>

        <br><br>
        <a href="index.html">Back to Main Page</a>
        <br><br>
        &lt;&lt;&lt;&nbsp; &copy; 2025 AquaCheese &nbsp;&gt;&gt;&gt;

        <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>
        <script src="firebase-config.js"></script>
        <script>
        (function waitForFirebaseAndRun(attempts = 0) {
        if (!(window.firebase && window.firebaseConfig && window._firebaseInitialized)) {
            if (attempts === 0) {
                console.warn('Waiting for Firebase to be ready...');
            }
            if (attempts > 100) {
                console.error('ERROR: Firebase config or initialization not detected after 5 seconds.');
                return;
            }
            setTimeout(() => waitForFirebaseAndRun(attempts + 1), 50);
            return;
        }
        function runLoginModalLogic() {
            const loginButton = document.getElementById('loginButton');
            const loginModal = document.getElementById('loginModal');
            const closeLoginModal = document.getElementById('closeLoginModal');
            const googleLoginButton = document.getElementById('googleLoginButton');
            const showEmailLoginFormBtn = document.getElementById('showEmailLoginForm');
            const showRegisterFormBtn = document.getElementById('showRegisterForm');
            const emailLoginForm = document.getElementById('emailLoginForm');
            const registerForm = document.getElementById('registerForm');
            const cancelEmailLoginBtn = document.getElementById('cancelEmailLogin');
            const cancelRegisterBtn = document.getElementById('cancelRegister');
            const emailInput = document.getElementById('emailInput');
            const passwordInput = document.getElementById('passwordInput');
            const emailLoginError = document.getElementById('emailLoginError');
            const uploadButtonSection = document.getElementById('upload-button-section');
            const logoutButton = document.getElementById('logoutButton');
            const profileMenu = document.getElementById('profileMenu');
            const viewProfileButton = document.getElementById('viewProfileButton');
            const logoutButton2 = document.getElementById('logoutButton2');
            if (!loginButton || !loginModal || !closeLoginModal || !googleLoginButton || !showEmailLoginFormBtn || !showRegisterFormBtn || !emailLoginForm || !registerForm || !cancelEmailLoginBtn || !cancelRegisterBtn || !emailInput || !passwordInput || !emailLoginError || !uploadButtonSection || !logoutButton || !profileMenu || !viewProfileButton || !logoutButton2) return;
            const auth = firebase.auth();
            const googleProvider = new firebase.auth.GoogleAuthProvider();
            function show(el) { el.classList.remove('hidden'); }
            function hide(el) { el.classList.add('hidden'); }
            function resetLoginModal() {
                hide(emailLoginForm);
                hide(registerForm);
                show(googleLoginButton);
                show(showEmailLoginFormBtn);
                show(showRegisterFormBtn);
                emailLoginError.textContent = '';
                if (typeof emailLoginForm.reset === 'function') emailLoginForm.reset();
                if (typeof registerForm.reset === 'function') registerForm.reset();
            }
            loginButton.addEventListener('click', () => {
                resetLoginModal();
                loginModal.style.display = 'block';
                loginModal.style.zIndex = '9999';
                loginModal.style.backgroundColor = 'rgba(0,0,0,0.5)';
                if (loginModal.firstElementChild) {
                    loginModal.firstElementChild.style.backgroundColor = '#333';
                    loginModal.firstElementChild.style.color = 'whitesmoke';
                    loginModal.firstElementChild.style.border = '';
                }
                const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
                if (loggedInUser) {
                    logoutButton.style.display = 'block';
                    logoutButton2.style.display = 'block';
                } else {
                    logoutButton.style.display = 'none';
                    logoutButton2.style.display = 'none';
                }
            });
            closeLoginModal.addEventListener('click', () => {
                loginModal.style.display = 'none';
                resetLoginModal();
            });
            showEmailLoginFormBtn.addEventListener('click', () => {
                hide(googleLoginButton);
                hide(showEmailLoginFormBtn);
                hide(showRegisterFormBtn);
                show(emailLoginForm);
                hide(registerForm);
                emailLoginError.textContent = '';
                if (typeof emailLoginForm.reset === 'function') emailLoginForm.reset();
            });
            cancelEmailLoginBtn.addEventListener('click', () => {
                show(googleLoginButton);
                hide(emailLoginForm);
                show(showEmailLoginFormBtn);
                show(showRegisterFormBtn);
                emailLoginError.textContent = '';
                if (typeof emailLoginForm.reset === 'function') emailLoginForm.reset();
            });
            showRegisterFormBtn.addEventListener('click', () => {
                hide(googleLoginButton);
                hide(showEmailLoginFormBtn);
                hide(showRegisterFormBtn);
                hide(emailLoginForm);
                show(registerForm);
                emailLoginError.textContent = '';
                if (typeof registerForm.reset === 'function') registerForm.reset();
            });
            cancelRegisterBtn.addEventListener('click', () => {
                show(googleLoginButton);
                hide(registerForm);
                show(showEmailLoginFormBtn);
                show(showRegisterFormBtn);
                emailLoginError.textContent = '';
                if (typeof registerForm.reset === 'function') registerForm.reset();
            });
            googleLoginButton.addEventListener('click', () => {
                auth.signInWithPopup(googleProvider)
                    .then((result) => {
                        const user = result.user;
                        localStorage.setItem('loggedInUser', JSON.stringify({
                            displayName: user.displayName || user.email,
                            profilePicUrl: user.photoURL,
                            email: user.email
                        }));
                        loginModal.style.display = 'none';
                        showUploadButtonIfAllowed(user.email);
                    })
                    .catch((error) => {
                        emailLoginError.textContent = 'Google Login Failed: ' + error.message;
                    });
            });
            emailLoginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                emailLoginError.textContent = '';
                const email = emailInput.value.trim();
                const password = passwordInput.value;
                auth.signInWithEmailAndPassword(email, password)
                    .then((result) => {
                        const user = result.user;
                        localStorage.setItem('loggedInUser', JSON.stringify({
                            displayName: user.displayName || user.email,
                            profilePicUrl: user.photoURL,
                            email: user.email
                        }));
                        loginModal.style.display = 'none';
                        showUploadButtonIfAllowed(user.email);
                    })
                    .catch((error) => {
                        emailLoginError.textContent = error.message.replace('Firebase: ', '');
                    });
            });
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                emailLoginError.textContent = '';
                const email = document.getElementById('registerEmail').value.trim();
                const password = document.getElementById('registerPassword').value;
                auth.createUserWithEmailAndPassword(email, password)
                    .then((result) => {
                        const user = result.user;
                        localStorage.setItem('loggedInUser', JSON.stringify({
                            displayName: user.displayName || user.email,
                            profilePicUrl: user.photoURL,
                            email: user.email
                        }));
                        loginModal.style.display = 'none';
                        registerForm.reset();
                        registerForm.style.display = 'none';
                        showEmailLoginFormBtn.style.display = 'inline-block';
                        showRegisterFormBtn.style.display = 'inline-block';
                        showUploadButtonIfAllowed(user.email);
                    })
                    .catch((error) => {
                        emailLoginError.textContent = error.message.replace('Firebase: ', '');
                    });
            });
            function showUploadButtonIfAllowed(email) {
                const allowedEmail = "aquacheese.yt@gmail.com";
                if (email === allowedEmail) {
                    uploadButtonSection.style.display = 'block';
                } else {
                    uploadButtonSection.style.display = 'none';
                }
            }
            // Remove duplicate logoutButton in profileMenu if present
    // const profileMenu = document.getElementById('profileMenu');
    // if (profileMenu) {
    //   const logoutBtns = profileMenu.querySelectorAll('#logoutButton');
    //   if (logoutBtns.length > 1) {
    //     for (let i = 1; i < logoutBtns.length; i++) {
    //       logoutBtns[i].remove();
    //     }
    //   }
    // }
            logoutButton.addEventListener('click', () => {
                localStorage.removeItem('loggedInUser');
                runLoginModalLogic();
                location.reload();
            });
            logoutButton2.addEventListener('click', () => {
                localStorage.removeItem('loggedInUser');
                runLoginModalLogic();
                location.reload();
            });
            const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser'));
            if (loggedInUser) {
                showUploadButtonIfAllowed(loggedInUser.email);
            }
        }
        runLoginModalLogic();
        })();
        // Handle form submission
            document.getElementById('paymentForm').addEventListener('submit', function (e) {
                e.preventDefault();

                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const amount = 20.00; // Fixed price for videos
                const paymentMethod = document.getElementById('paymentMethod').value;

                alert(`Processing payment of £${amount.toFixed(2)} for ${name} (${email}) using ${paymentMethod}.`);

                // Placeholder for payment processing logic
                // You can integrate Stripe, PayPal, or another payment gateway here
                console.log('Payment details:', { name, email, amount, paymentMethod });

                // Redirect to a success page or display a success message
                alert('Payment successful! Thank you for your purchase.');
                window.location.href = 'index.html';
            });
        </script>
    </body>
</html>